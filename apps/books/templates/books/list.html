{# apps/books/templates/books/list.html #}
{% extends "base.html" %}

{% block title %}Books List{% endblock %}

{% block content %}
<div class="max-w-[85%] mx-auto mt-6 bg-white shadow rounded-xl p-4">

<div class="flex justify-between items-center mb-4">
    <h2 class="text-lg font-semibold border-b-2 border-gray-300 pb-1">
        List of Books
    </h2>
    <a href="{{ url_for('books.add') }}"
       class="bg-blue-500 hover:bg-blue-600 text-white text-sm px-3 py-1 rounded
       {% if session.username != 'admin' %} cursor-not-allowed opacity-50 {% endif %}"
       {% if session.username != 'admin' %} onclick="event.preventDefault();" {% endif %}>
        Add Book
    </a>
</div>

<div class="overflow-x-auto">
<table id="data-tables-id" class="table-auto min-w-full bg-white">
<thead class="text-sm text-gray-600 uppercase">
<tr>
    <th class="px-4 py-2 border-b">ID</th>
    <th class="px-4 py-2 border-b">Title</th>
    <th class="px-4 py-2 border-b">Author</th>
    <th class="px-4 py-2 border-b">Published</th>
    <th class="px-4 py-2 border-b">Category</th>
    <th class="px-2 py-2 border-b text-center">Actions</th>
</tr>
</thead>

<tbody class="text-sm text-gray-700">
{% for item in items %}
<tr class="hover:bg-gray-50">
    <td class="px-4 py-2 border-b">{{ item.id }}</td>
    <td class="px-4 py-2 border-b">{{ item.title }}</td>
    <td class="px-4 py-2 border-b">{{ item.author }}</td>
    <td class="px-4 py-2 border-b">{{ item.published_date }}</td>
    <td class="px-4 py-2 border-b">{{ item.category_name }}</td>

    <td class="px-2 py-2 border-b">
        <div class="flex gap-1 justify-center">
            <a href="{{ url_for('books.view', id=item.id) }}"
               class="bg-gray-200 hover:bg-gray-300 text-xs px-2 py-1 rounded">
                View
            </a>

            <a href="{{ url_for('books.edit', id=item.id) }}"
               class="bg-yellow-200 hover:bg-yellow-300 text-xs px-2 py-1 rounded
               {% if session.username != 'admin' %} cursor-not-allowed opacity-50 {% endif %}"
               {% if session.username != 'admin' %} onclick="event.preventDefault();" {% endif %}>
                Edit
            </a>

            <form action="{{ url_for('books.delete', id=item.id) }}" method="post">
                <button type="submit"
                        onclick="return confirm('Delete this book?');"
                        class="bg-red-200 hover:bg-red-300 text-xs px-2 py-1 rounded
                        {% if session.username != 'admin' %} cursor-not-allowed opacity-50 {% endif %}"
                        {% if session.username != 'admin' %} onclick="event.preventDefault();" {% endif %}>
                    Del
                </button>
            </form>
        </div>
    </td>
</tr>
{% else %}
<tr>
    <td colspan="6" class="px-4 py-2 text-gray-600">No books found.</td>
</tr>
{% endfor %}
</tbody>
</table>
</div>
</div>
{% endblock %}
